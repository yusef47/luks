# ๐ ูุธุงู ุงูุชุจุฏูู ุงูุชููุงุฆู ููููุงุชูุญ

## ๐ฏ ุงูููุฑุฉ ุงูุฃุณุงุณูุฉ

ุนูุฏ ุญุฏูุซ ุฎุทุฃ **429** (Quota Exceeded) ุฃู **503** (Service Overloaded)ุ ุงููุธุงู ูููู **ุชููุงุฆูุงู** ุจู:

1. โ ุชุณุฌูู ุงูุฎุทุฃ
2. โ ุชุจุฏูู ุงูููุชุงุญ
3. โ ุฅุนุงุฏุฉ ุงููุญุงููุฉ
4. โ **ุงูุงุณุชูุฑุงุฑ ูู ุงููุญุงุฏุซุฉ ุจุฏูู ุชููู**

---

## ๐ ููููุฉ ุงูุนูู

### ุงูููุงุชูุญ ุงููุชุงุญุฉ:
```
GEMINI_API_KEY_1 โ SearchAgent
GEMINI_API_KEY_2 โ MapsAgent
GEMINI_API_KEY_3 โ VisionAgent
GEMINI_API_KEY_4 โ VideoAgent
GEMINI_API_KEY_5 โ ImageGenerationAgent
GEMINI_API_KEY   โ Default (ุงุญุชูุงุทู)
```

### ุนูุฏ ุญุฏูุซ ุฎุทุฃ 429 ุฃู 503:

```
ุงูุทูุจ ุงูุฃูู (GEMINI_API_KEY_1)
    โ
โ ุฎุทุฃ 429
    โ
ุชุณุฌูู ุงููุดู (failures = 1)
    โ
ุงูุชุจุฏูู ุฅูู ููุชุงุญ ุขุฎุฑ
    โ
ุฅุนุงุฏุฉ ุงููุญุงููุฉ
    โ
โ ูุฌุงุญ!
```

---

## ๐ ูุธุงู ุงูุชุชุจุน

### ูุนูููุงุช ูุชู ุชุชุจุนูุง:

```javascript
keyStats = {
  SearchAgent: {
    failures: 0,        // ุนุฏุฏ ุงูุฃุฎุทุงุก
    lastError: null     // ุขุฎุฑ ุฑุณุงูุฉ ุฎุทุฃ
  },
  MapsAgent: { ... },
  // ... ุงููุฒูุฏ
}
```

### ุฅุนุงุฏุฉ ุชุนููู ุงูุฃุฎุทุงุก:
- โ ุจุนุฏ **1 ุฏูููุฉ** ูู ุขุฎุฑ ุฎุทุฃุ ูุชู ุฅุนุงุฏุฉ ุชุนููู ุงูุนุฏุงุฏ
- โ ูุฐุง ูุณูุญ ููููุชุงุญ ุจุงูุนูู ูุฑุฉ ุฃุฎุฑู

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### ุชุญูู ูู ุญุงูุฉ ุงูููุงุชูุญ:
```bash
curl http://localhost:5000/api/keys-status
```

**ุงููุชูุฌุฉ:**
```json
{
  "SearchAgent": {
    "status": "โ Active",
    "failures": 0,
    "lastError": null
  },
  "MapsAgent": {
    "status": "โ Active",
    "failures": 0,
    "lastError": null
  },
  ...
}
```

---

## ๐ ุงูุณููู ุนูุฏ ุงูุฃุฎุทุงุก

### ุฎุทุฃ 429 (Quota Exceeded):
```
โ You exceeded your current quota
    โ
โ๏ธ ุชุณุฌูู ุงูุฎุทุฃ
    โ
๐ ุงูุชุจุฏูู ุฅูู ููุชุงุญ ุขุฎุฑ
    โ
โ ุฅุนุงุฏุฉ ุงููุญุงููุฉ
    โ
โ ุงููุฌุงุญ!
```

### ุฎุทุฃ 503 (Service Overloaded):
```
โ The model is overloaded
    โ
โ๏ธ ุชุณุฌูู ุงูุฎุทุฃ
    โ
๐ ุงูุชุจุฏูู ุฅูู ููุชุงุญ ุขุฎุฑ
    โ
โ ุฅุนุงุฏุฉ ุงููุญุงููุฉ
    โ
โ ุงููุฌุงุญ!
```

---

## ๐ก ุงููููุฒุงุช

| ุงูููุฒุฉ | ุงููุตู |
|-------|-------|
| **ุชุจุฏูู ุชููุงุฆู** | ุจุฏูู ุชุฏุฎู ูุฏูู |
| **ุจุฏูู ุชููู** | ุงููุญุงุฏุซุฉ ุชุณุชูุฑ |
| **ุชุชุจุน ุงูุฃุฎุทุงุก** | ูุนุฑูุฉ ุฃู ููุชุงุญ ููู ูุดุงูู |
| **ุฅุนุงุฏุฉ ุชุนููู ุฐููุฉ** | ุจุนุฏ 1 ุฏูููุฉ |
| **Fallback Plan** | ุฎุทุฉ ุงุญุชูุงุทูุฉ ุฅุฐุง ูุดู ูู ุดูุก |

---

## ๐ ุงูุฃุฏุงุก

### ูุจู ุงููุธุงู:
- โ ุชููู ุงููุญุงุฏุซุฉ ุนูุฏ 429
- โ ุฑุณุงูุฉ ุฎุทุฃ ูููุณุชุฎุฏู
- โ ูุถุทุฑ ุงููุณุชุฎุฏู ูููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู

### ุจุนุฏ ุงููุธุงู:
- โ ุชุจุฏูู ุชููุงุฆู ููููุชุงุญ
- โ ุงููุญุงุฏุซุฉ ุชุณุชูุฑ ุจุณูุงุณุฉ
- โ ุจุฏูู ุฑุณุงุฆู ุฎุทุฃ
- โ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุณูุณุฉ

---

## ๐ง ุงูุชูููู

### ูู `.env`:
```
GEMINI_API_KEY_1=your_key_1
GEMINI_API_KEY_2=your_key_2
GEMINI_API_KEY_3=your_key_3
GEMINI_API_KEY_4=your_key_4
GEMINI_API_KEY_5=your_key_5
GEMINI_API_KEY=your_default_key
```

### ูู `server.js`:
```javascript
// ุงููุธุงู ูุชุนุงูู ูุน ุงูุชุจุฏูู ุชููุงุฆูุงู
const getAIInstance = (agent) => {
  // ุฅุฐุง ูุงู ููุงู ุฃุฎุทุงุก ูุซูุฑุฉุ ุงุณุชุฎุฏู ุงูููุชุงุญ ุงูุงุญุชูุงุทู
  if (keyStats[agent].failures > 2) {
    return aiInstances.default;
  }
  return aiInstances[agent];
};
```

---

## ๐ฏ ุงูุฎูุงุตุฉ

**ุงูุขู:**
- โ ูุง ุชููู ุนูุฏ ุฃุฎุทุงุก ุงูููุชุฉ
- โ ุชุจุฏูู ุชููุงุฆู ููููุงุชูุญ
- โ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุณูุณุฉ
- โ ุจุฏูู ูููุฏ ุนูู ุงูุทูุจุงุช

**ุงููุดุฑูุน ุฌุงูุฒ ููุงุณุชุฎุฏุงู ุงูููุฑู!** ๐
